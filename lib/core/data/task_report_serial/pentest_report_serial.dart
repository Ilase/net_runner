import 'package:json_annotation/json_annotation.dart';

part 'pentest_report_serial.g.dart';

@JsonSerializable()
class PentestReport {
  GeneralInfo general_info;
  Map<String, PentestDiff> diff;
  Map<String, PentestHost> hosts;

  PentestReport({
    required this.general_info,
    required this.diff,
    required this.hosts,
  });

  factory PentestReport.fromJson(Map<String, dynamic> json) =>
      _$PentestReportFromJson(json);
  Map<String, dynamic> toJson() => _$PentestReportToJson(this);
}

@JsonSerializable()
class GeneralInfo {
  String task_name;
  String start;
  String end;
  String version;
  String elapsed;
  String summary;
  int up;
  int down;
  int total;

  GeneralInfo({
    required this.task_name,
    required this.start,
    required this.end,
    required this.version,
    required this.elapsed,
    required this.summary,
    required this.up,
    required this.down,
    required this.total,
  });

  factory GeneralInfo.fromJson(Map<String, dynamic> json) =>
      _$GeneralInfoFromJson(json);
  Map<String, dynamic> toJson() => _$GeneralInfoToJson(this);
}

@JsonSerializable()
class PentestHost {
  String ip;
  List<PentestPort> ports;
  String status;
  Map<String, PentestVulns> vulns;

  PentestHost({
    required this.ip,
    required this.ports,
    required this.status,
    required this.vulns,
  });

  factory PentestHost.fromJson(Map<String, dynamic> json) =>
      _$PentestHostFromJson(json);
  Map<String, dynamic> toJson() => _$PentestHostToJson(this);
}

@JsonSerializable()
class PentestPort {
  int port;
  String protocol;
  String service;
  String state;

  PentestPort({
    required this.port,
    required this.protocol,
    required this.state,
    required this.service,
  });

  factory PentestPort.fromJson(Map<String, dynamic> json) =>
      _$PentestPortFromJson(json);
  Map<String, dynamic> toJson() => _$PentestPortToJson(this);
}

@JsonSerializable()
class PentestVulns {
  String cpe;
  String cvss;
  String cvss_vector;
  List<String> cwe;
  String description;
  String id;
  int port;
  String references;
  String solutions;

  PentestVulns({
    required this.cpe,
    required this.cvss,
    required this.cvss_vector,
    required this.cwe,
    required this.description,
    required this.id,
    required this.port,
    required this.references,
    required this.solutions,
  });

  factory PentestVulns.fromJson(Map<String, dynamic> json) =>
      _$PentestVulnsFromJson(json);
  Map<String, dynamic> toJson() => _$PentestVulnsToJson(this);
}

@JsonSerializable()
class PentestDiff {
  Map<String, PentestVulns> added;
  Map<String, PentestVulns> removed;

  PentestDiff({required this.added, required this.removed});

  factory PentestDiff.fromJson(Map<String, dynamic> json) =>
      _$PentestDiffFromJson(json);
  Map<String, dynamic> toJson() => _$PentestDiffToJson(this);
}
